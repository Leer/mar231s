<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>data.table pt2 | Автоматизированный сбор больших данных в экономико-социологических исследованиях</title>
  <meta name="description" content="data.table pt2 | Автоматизированный сбор больших данных в экономико-социологических исследованиях" />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="data.table pt2 | Автоматизированный сбор больших данных в экономико-социологических исследованиях" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="data.table pt2 | Автоматизированный сбор больших данных в экономико-социологических исследованиях" />
  
  
  

<meta name="author" content="Ph.A.Upravitelev" />


<meta name="date" content="2023-11-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data.table-pt1.html"/>
<link rel="next" href="data.table-pt3.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.2/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R course</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Intro</a></li>
<li class="chapter" data-level="" data-path="overview.html"><a href="overview.html"><i class="fa fa-check"></i>Введение</a>
<ul>
<li class="chapter" data-level="" data-path="overview.html"><a href="overview.html#запись-занятия"><i class="fa fa-check"></i>Запись занятия</a></li>
<li class="chapter" data-level="" data-path="overview.html"><a href="overview.html#data-culture"><i class="fa fa-check"></i>Data culture</a></li>
<li class="chapter" data-level="" data-path="overview.html"><a href="overview.html#обо-мне"><i class="fa fa-check"></i>Обо мне</a></li>
<li class="chapter" data-level="" data-path="overview.html"><a href="overview.html#contacts"><i class="fa fa-check"></i>Contacts</a></li>
<li class="chapter" data-level="" data-path="overview.html"><a href="overview.html#mm-invite-link"><i class="fa fa-check"></i>MM invite link</a></li>
<li class="chapter" data-level="" data-path="overview.html"><a href="overview.html#syllabus"><i class="fa fa-check"></i>Syllabus</a></li>
<li class="chapter" data-level="" data-path="overview.html"><a href="overview.html#r-intro"><i class="fa fa-check"></i>R intro</a>
<ul>
<li class="chapter" data-level="" data-path="overview.html"><a href="overview.html#short-history"><i class="fa fa-check"></i>Short history</a></li>
<li class="chapter" data-level="" data-path="overview.html"><a href="overview.html#r-ecosystem"><i class="fa fa-check"></i>R ecosystem</a></li>
<li class="chapter" data-level="" data-path="overview.html"><a href="overview.html#r-rstudio"><i class="fa fa-check"></i>R + RStudio</a></li>
<li class="chapter" data-level="" data-path="overview.html"><a href="overview.html#альтернативные-ide"><i class="fa fa-check"></i>Альтернативные IDE</a></li>
<li class="chapter" data-level="" data-path="overview.html"><a href="overview.html#style-guide"><i class="fa fa-check"></i>Style guide</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="overview.html"><a href="overview.html#синтаксис"><i class="fa fa-check"></i>Синтаксис</a>
<ul>
<li class="chapter" data-level="" data-path="overview.html"><a href="overview.html#структура-выражения"><i class="fa fa-check"></i>Структура выражения</a></li>
<li class="chapter" data-level="" data-path="overview.html"><a href="overview.html#вывод-на-печать"><i class="fa fa-check"></i>Вывод на печать</a></li>
<li class="chapter" data-level="" data-path="overview.html"><a href="overview.html#присваивание"><i class="fa fa-check"></i>Присваивание</a></li>
<li class="chapter" data-level="" data-path="overview.html"><a href="overview.html#операторы-присвоения"><i class="fa fa-check"></i>Операторы присвоения</a></li>
<li class="chapter" data-level="" data-path="overview.html"><a href="overview.html#арифметические-операторы"><i class="fa fa-check"></i>Арифметические операторы</a></li>
<li class="chapter" data-level="" data-path="overview.html"><a href="overview.html#операторы-сравнения"><i class="fa fa-check"></i>Операторы сравнения</a></li>
<li class="chapter" data-level="" data-path="overview.html"><a href="overview.html#логические-операторы"><i class="fa fa-check"></i>Логические операторы</a></li>
<li class="chapter" data-level="" data-path="overview.html"><a href="overview.html#комментарии-и-кавычки"><i class="fa fa-check"></i>Комментарии и кавычки</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="overview.html"><a href="overview.html#окружение-и-подсказки"><i class="fa fa-check"></i>Окружение и подсказки</a>
<ul>
<li class="chapter" data-level="" data-path="overview.html"><a href="overview.html#полезные-функции-для-работы-с-окружением"><i class="fa fa-check"></i>Полезные функции для работы с окружением</a></li>
<li class="chapter" data-level="" data-path="overview.html"><a href="overview.html#help"><i class="fa fa-check"></i>help</a></li>
<li class="chapter" data-level="" data-path="overview.html"><a href="overview.html#стандартные-ошибки-в-синтаксисе"><i class="fa fa-check"></i>Стандартные ошибки в синтаксисе</a></li>
<li class="chapter" data-level="" data-path="overview.html"><a href="overview.html#object-not-found"><i class="fa fa-check"></i>Object not found</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="overview.html"><a href="overview.html#дополнительные-материалы"><i class="fa fa-check"></i>Дополнительные материалы</a></li>
<li class="chapter" data-level="" data-path="overview.html"><a href="overview.html#домашнее-задание"><i class="fa fa-check"></i>Домашнее задание</a>
<ul>
<li class="chapter" data-level="" data-path="overview.html"><a href="overview.html#организационное-mm"><i class="fa fa-check"></i>Организационное / MM</a></li>
<li class="chapter" data-level="" data-path="overview.html"><a href="overview.html#r"><i class="fa fa-check"></i>R</a></li>
<li class="chapter" data-level="" data-path="overview.html"><a href="overview.html#rstudio"><i class="fa fa-check"></i>RStudio</a></li>
<li class="chapter" data-level="" data-path="overview.html"><a href="overview.html#операторы-и-создание-векторов"><i class="fa fa-check"></i>Операторы и создание векторов</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="vectors.html"><a href="vectors.html"><i class="fa fa-check"></i>Векторы</a>
<ul>
<li class="chapter" data-level="" data-path="vectors.html"><a href="vectors.html#запись-занятия-1"><i class="fa fa-check"></i>Запись занятия</a></li>
<li class="chapter" data-level="" data-path="vectors.html"><a href="vectors.html#векторы"><i class="fa fa-check"></i>Векторы</a>
<ul>
<li class="chapter" data-level="" data-path="vectors.html"><a href="vectors.html#атомарные-типы-данных"><i class="fa fa-check"></i>Атомарные типы данных</a></li>
<li class="chapter" data-level="" data-path="vectors.html"><a href="vectors.html#создание-векторов"><i class="fa fa-check"></i>Создание векторов</a></li>
<li class="chapter" data-level="" data-path="vectors.html"><a href="vectors.html#приведение-типов"><i class="fa fa-check"></i>Приведение типов</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="vectors.html"><a href="vectors.html#выбор-элемента-вектора"><i class="fa fa-check"></i>Выбор элемента вектора</a>
<ul>
<li class="chapter" data-level="" data-path="vectors.html"><a href="vectors.html#выбор-по-номеру-позиции"><i class="fa fa-check"></i>Выбор по номеру позиции</a></li>
<li class="chapter" data-level="" data-path="vectors.html"><a href="vectors.html#выбор-по-значению"><i class="fa fa-check"></i>Выбор по значению</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="vectors.html"><a href="vectors.html#проверка-на-na"><i class="fa fa-check"></i>Проверка на NA</a></li>
<li class="chapter" data-level="" data-path="vectors.html"><a href="vectors.html#домашнее-задание-1"><i class="fa fa-check"></i>Домашнее задание</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="lists.html"><a href="lists.html"><i class="fa fa-check"></i>Списки и таблицы</a>
<ul>
<li class="chapter" data-level="" data-path="lists.html"><a href="lists.html#запись-занятия-23-сентября"><i class="fa fa-check"></i>Запись занятия 23 сентября</a></li>
<li class="chapter" data-level="" data-path="lists.html"><a href="lists.html#векторы-1"><i class="fa fa-check"></i>Векторы</a>
<ul>
<li class="chapter" data-level="" data-path="lists.html"><a href="lists.html#поиск-по-вхождению-в-массив"><i class="fa fa-check"></i>Поиск по вхождению в массив</a></li>
<li class="chapter" data-level="" data-path="lists.html"><a href="lists.html#поиск-по-строке"><i class="fa fa-check"></i>Поиск по строке</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="lists.html"><a href="lists.html#векторизованные-операции"><i class="fa fa-check"></i>Векторизованные операции</a></li>
<li class="chapter" data-level="" data-path="lists.html"><a href="lists.html#recycling"><i class="fa fa-check"></i>Recycling</a></li>
<li class="chapter" data-level="" data-path="lists.html"><a href="lists.html#изменение-элементов-объектов"><i class="fa fa-check"></i>Изменение элементов объектов</a></li>
<li class="chapter" data-level="" data-path="lists.html"><a href="lists.html#списки"><i class="fa fa-check"></i>Списки</a>
<ul>
<li class="chapter" data-level="" data-path="lists.html"><a href="lists.html#создание-списков"><i class="fa fa-check"></i>Создание списков</a></li>
<li class="chapter" data-level="" data-path="lists.html"><a href="lists.html#именованные-списки"><i class="fa fa-check"></i>Именованные списки</a></li>
<li class="chapter" data-level="" data-path="lists.html"><a href="lists.html#выбор-элемента-списка"><i class="fa fa-check"></i>Выбор элемента списка</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="lists.html"><a href="lists.html#структура-объектов"><i class="fa fa-check"></i>Структура объектов</a></li>
<li class="chapter" data-level="" data-path="lists.html"><a href="lists.html#таблицы"><i class="fa fa-check"></i>Таблицы</a>
<ul>
<li class="chapter" data-level="" data-path="lists.html"><a href="lists.html#data.frame-vs-data.table-vs-dplyr"><i class="fa fa-check"></i>data.frame vs data.table vs dplyr</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="lists.html"><a href="lists.html#data.table"><i class="fa fa-check"></i>data.table</a>
<ul>
<li class="chapter" data-level="" data-path="lists.html"><a href="lists.html#преимущества-data.table"><i class="fa fa-check"></i>Преимущества data.table</a></li>
<li class="chapter" data-level="" data-path="lists.html"><a href="lists.html#установка-и-подключение-пакета"><i class="fa fa-check"></i>Установка и подключение пакета</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="lists.html"><a href="lists.html#создание-data.table-таблиц"><i class="fa fa-check"></i>Создание data.table-таблиц</a></li>
<li class="chapter" data-level="" data-path="lists.html"><a href="lists.html#основная-формула-dt-синтаксиса"><i class="fa fa-check"></i>Основная формула dt-синтаксиса</a></li>
<li class="chapter" data-level="" data-path="lists.html"><a href="lists.html#создание-data.table-таблиц-1"><i class="fa fa-check"></i>Создание data.table-таблиц</a></li>
<li class="chapter" data-level="" data-path="lists.html"><a href="lists.html#выбор-строки"><i class="fa fa-check"></i>Выбор строки</a></li>
<li class="chapter" data-level="" data-path="lists.html"><a href="lists.html#дополнительные-материалы-1"><i class="fa fa-check"></i>Дополнительные материалы</a></li>
<li class="chapter" data-level="" data-path="lists.html"><a href="lists.html#домашнее-задание-2"><i class="fa fa-check"></i>Домашнее задание</a>
<ul>
<li class="chapter" data-level="" data-path="lists.html"><a href="lists.html#векторы-2"><i class="fa fa-check"></i>векторы</a></li>
<li class="chapter" data-level="" data-path="lists.html"><a href="lists.html#списки-1"><i class="fa fa-check"></i>списки</a></li>
<li class="chapter" data-level="" data-path="lists.html"><a href="lists.html#таблицы.-импорт-данных"><i class="fa fa-check"></i>таблицы. импорт данных</a></li>
<li class="chapter" data-level="" data-path="lists.html"><a href="lists.html#работа-со-строками"><i class="fa fa-check"></i>работа со строками</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="data.table-pt1.html"><a href="data.table-pt1.html"><i class="fa fa-check"></i>data.table pt1</a>
<ul>
<li class="chapter" data-level="" data-path="data.table-pt1.html"><a href="data.table-pt1.html#запись-занятия-2"><i class="fa fa-check"></i>Запись занятия</a></li>
<li class="chapter" data-level="" data-path="data.table-pt1.html"><a href="data.table-pt1.html#разбор-домашней-работы"><i class="fa fa-check"></i>Разбор домашней работы</a>
<ul>
<li class="chapter" data-level="" data-path="data.table-pt1.html"><a href="data.table-pt1.html#списки-2"><i class="fa fa-check"></i>списки</a></li>
<li class="chapter" data-level="" data-path="data.table-pt1.html"><a href="data.table-pt1.html#таблицы.-импорт-данных-1"><i class="fa fa-check"></i>таблицы. импорт данных</a></li>
<li class="chapter" data-level="" data-path="data.table-pt1.html"><a href="data.table-pt1.html#работа-со-строками-1"><i class="fa fa-check"></i>работа со строками</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="data.table-pt1.html"><a href="data.table-pt1.html#основная-формула-dt-синтаксиса-1"><i class="fa fa-check"></i>Основная формула dt-синтаксиса</a></li>
<li class="chapter" data-level="" data-path="data.table-pt1.html"><a href="data.table-pt1.html#создание-data.table-таблиц-2"><i class="fa fa-check"></i>Создание data.table-таблиц</a></li>
<li class="chapter" data-level="" data-path="data.table-pt1.html"><a href="data.table-pt1.html#выбор-строки-1"><i class="fa fa-check"></i>Выбор строки</a></li>
<li class="chapter" data-level="" data-path="data.table-pt1.html"><a href="data.table-pt1.html#работа-с-колонками"><i class="fa fa-check"></i>Работа с колонками</a>
<ul>
<li class="chapter" data-level="" data-path="data.table-pt1.html"><a href="data.table-pt1.html#обращение-к-колонке"><i class="fa fa-check"></i>Обращение к колонке</a></li>
<li class="chapter" data-level="" data-path="data.table-pt1.html"><a href="data.table-pt1.html#выбор-нескольких-колонок"><i class="fa fa-check"></i>Выбор нескольких колонок</a></li>
<li class="chapter" data-level="" data-path="data.table-pt1.html"><a href="data.table-pt1.html#cоздание-колонок"><i class="fa fa-check"></i>Cоздание колонок</a></li>
<li class="chapter" data-level="" data-path="data.table-pt1.html"><a href="data.table-pt1.html#модификация-колонок"><i class="fa fa-check"></i>Модификация колонок</a></li>
<li class="chapter" data-level="" data-path="data.table-pt1.html"><a href="data.table-pt1.html#удаление-колонок"><i class="fa fa-check"></i>Удаление колонок</a></li>
<li class="chapter" data-level="" data-path="data.table-pt1.html"><a href="data.table-pt1.html#вычисления-по-одной-колонке"><i class="fa fa-check"></i>Вычисления по одной колонке</a></li>
<li class="chapter" data-level="" data-path="data.table-pt1.html"><a href="data.table-pt1.html#группировка-по-нескольким-полям"><i class="fa fa-check"></i>Группировка по нескольким полям</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="data.table-pt1.html"><a href="data.table-pt1.html#sd-advanced"><i class="fa fa-check"></i>.SD (Advanced)</a></li>
<li class="chapter" data-level="" data-path="data.table-pt1.html"><a href="data.table-pt1.html#полезные-ссылки"><i class="fa fa-check"></i>Полезные ссылки</a></li>
<li class="chapter" data-level="" data-path="data.table-pt1.html"><a href="data.table-pt1.html#домашнее-задание-3"><i class="fa fa-check"></i>Домашнее задание</a>
<ul>
<li class="chapter" data-level="" data-path="data.table-pt1.html"><a href="data.table-pt1.html#работа-с-колонками-1"><i class="fa fa-check"></i>работа с колонками</a></li>
<li class="chapter" data-level="" data-path="data.table-pt1.html"><a href="data.table-pt1.html#для-тех-кто-любит-посложнее"><i class="fa fa-check"></i>для тех, кто любит посложнее</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="data.table-pt2.html"><a href="data.table-pt2.html"><i class="fa fa-check"></i>data.table pt2</a>
<ul>
<li class="chapter" data-level="" data-path="data.table-pt2.html"><a href="data.table-pt2.html#запись-занятия-3"><i class="fa fa-check"></i>Запись занятия</a></li>
<li class="chapter" data-level="" data-path="data.table-pt2.html"><a href="data.table-pt2.html#разбор-домашней-работы-1"><i class="fa fa-check"></i>Разбор домашней работы</a>
<ul>
<li class="chapter" data-level="" data-path="data.table-pt2.html"><a href="data.table-pt2.html#работа-с-колонками-2"><i class="fa fa-check"></i>работа с колонками</a></li>
<li class="chapter" data-level="" data-path="data.table-pt2.html"><a href="data.table-pt2.html#для-тех-кто-любит-посложнее-1"><i class="fa fa-check"></i>для тех, кто любит посложнее</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="data.table-pt2.html"><a href="data.table-pt2.html#применение-функций"><i class="fa fa-check"></i>Применение функций</a>
<ul>
<li class="chapter" data-level="" data-path="data.table-pt2.html"><a href="data.table-pt2.html#dataset"><i class="fa fa-check"></i>dataset</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="data.table-pt2.html"><a href="data.table-pt2.html#применение-функций-1"><i class="fa fa-check"></i>Применение функций</a>
<ul>
<li class="chapter" data-level="" data-path="data.table-pt2.html"><a href="data.table-pt2.html#количество-строк-и-значений-.n-uniquen"><i class="fa fa-check"></i>Количество строк и значений: .N, uniqueN</a></li>
<li class="chapter" data-level="" data-path="data.table-pt2.html"><a href="data.table-pt2.html#ветвления-ifelse-fifelse"><i class="fa fa-check"></i>Ветвления: ifelse / fifelse</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="data.table-pt2.html"><a href="data.table-pt2.html#агрегации"><i class="fa fa-check"></i>Агрегации</a>
<ul>
<li class="chapter" data-level="" data-path="data.table-pt2.html"><a href="data.table-pt2.html#вычисления-по-одной-колонке-1"><i class="fa fa-check"></i>Вычисления по одной колонке</a></li>
<li class="chapter" data-level="" data-path="data.table-pt2.html"><a href="data.table-pt2.html#вычисления-по-нескольким-колонкам"><i class="fa fa-check"></i>Вычисления по нескольким колонкам</a></li>
<li class="chapter" data-level="" data-path="data.table-pt2.html"><a href="data.table-pt2.html#группировка-по-нескольким-полям-1"><i class="fa fa-check"></i>Группировка по нескольким полям</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="data.table-pt2.html"><a href="data.table-pt2.html#манипуляции-с-таблицами"><i class="fa fa-check"></i>Манипуляции с таблицами</a>
<ul>
<li class="chapter" data-level="" data-path="data.table-pt2.html"><a href="data.table-pt2.html#rbind"><i class="fa fa-check"></i>rbind()</a></li>
<li class="chapter" data-level="" data-path="data.table-pt2.html"><a href="data.table-pt2.html#cbind"><i class="fa fa-check"></i>cbind()</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="data.table-pt2.html"><a href="data.table-pt2.html#домашнее-задание-4"><i class="fa fa-check"></i>Домашнее задание</a>
<ul>
<li class="chapter" data-level="" data-path="data.table-pt2.html"><a href="data.table-pt2.html#level-1-iatytd"><i class="fa fa-check"></i>level 1 (IATYTD)</a></li>
<li class="chapter" data-level="" data-path="data.table-pt2.html"><a href="data.table-pt2.html#level-2-hntr"><i class="fa fa-check"></i>level 2 (HNTR)</a></li>
<li class="chapter" data-level="" data-path="data.table-pt2.html"><a href="data.table-pt2.html#level-3-hmp"><i class="fa fa-check"></i>level 3 (HMP)</a></li>
<li class="chapter" data-level="" data-path="data.table-pt2.html"><a href="data.table-pt2.html#level-4-uv"><i class="fa fa-check"></i>level 4 (UV)</a></li>
<li class="chapter" data-level="" data-path="data.table-pt2.html"><a href="data.table-pt2.html#level-5-n"><i class="fa fa-check"></i>level 5 (N)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="data.table-pt3.html"><a href="data.table-pt3.html"><i class="fa fa-check"></i>data.table pt3</a>
<ul>
<li class="chapter" data-level="" data-path="data.table-pt3.html"><a href="data.table-pt3.html#запись-занятия-4"><i class="fa fa-check"></i>Запись занятия</a></li>
<li class="chapter" data-level="" data-path="data.table-pt3.html"><a href="data.table-pt3.html#разбор-домашней-работы-2"><i class="fa fa-check"></i>Разбор домашней работы</a>
<ul>
<li class="chapter" data-level="" data-path="data.table-pt3.html"><a href="data.table-pt3.html#level-3-hmp-1"><i class="fa fa-check"></i>level 3 (HMP)</a></li>
<li class="chapter" data-level="" data-path="data.table-pt3.html"><a href="data.table-pt3.html#level-4-uv-1"><i class="fa fa-check"></i>level 4 (UV)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="data.table-pt3.html"><a href="data.table-pt3.html#манипуляции-с-таблицами-1"><i class="fa fa-check"></i>Манипуляции с таблицами</a>
<ul>
<li class="chapter" data-level="" data-path="data.table-pt3.html"><a href="data.table-pt3.html#merge"><i class="fa fa-check"></i>merge()</a></li>
<li class="chapter" data-level="" data-path="data.table-pt3.html"><a href="data.table-pt3.html#long-wide-форматы-данных"><i class="fa fa-check"></i>long / wide-форматы данных</a></li>
<li class="chapter" data-level="" data-path="data.table-pt3.html"><a href="data.table-pt3.html#dcast"><i class="fa fa-check"></i>dcast()</a></li>
<li class="chapter" data-level="" data-path="data.table-pt3.html"><a href="data.table-pt3.html#melt"><i class="fa fa-check"></i>melt()</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="data.table-pt3.html"><a href="data.table-pt3.html#соотношение-list-и-в-операциях-над-колонками."><i class="fa fa-check"></i>Соотношение list() и <code>:=</code> в операциях над колонками.</a></li>
<li class="chapter" data-level="" data-path="data.table-pt3.html"><a href="data.table-pt3.html#домашнее-задание-5"><i class="fa fa-check"></i>Домашнее задание</a>
<ul>
<li class="chapter" data-level="" data-path="data.table-pt3.html"><a href="data.table-pt3.html#level-1-iatytd-1"><i class="fa fa-check"></i>level 1 (IATYTD)</a></li>
<li class="chapter" data-level="" data-path="data.table-pt3.html"><a href="data.table-pt3.html#level-2-hntr-1"><i class="fa fa-check"></i>level 2 (HNTR)</a></li>
<li class="chapter" data-level="" data-path="data.table-pt3.html"><a href="data.table-pt3.html#level-3-hmp-2"><i class="fa fa-check"></i>level 3 (HMP)</a></li>
<li class="chapter" data-level="" data-path="data.table-pt3.html"><a href="data.table-pt3.html#level-4-uv-2"><i class="fa fa-check"></i>level 4 (UV)</a></li>
<li class="chapter" data-level="" data-path="data.table-pt3.html"><a href="data.table-pt3.html#level-5-n-1"><i class="fa fa-check"></i>level 5 (N)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="dt-etl.html"><a href="dt-etl.html"><i class="fa fa-check"></i>dt + ETL</a>
<ul>
<li class="chapter" data-level="" data-path="dt-etl.html"><a href="dt-etl.html#запись-занятия-5"><i class="fa fa-check"></i>Запись занятия</a></li>
<li class="chapter" data-level="" data-path="dt-etl.html"><a href="dt-etl.html#разбор-домашней-работы-3"><i class="fa fa-check"></i>Разбор домашней работы</a>
<ul>
<li class="chapter" data-level="" data-path="dt-etl.html"><a href="dt-etl.html#level-3-hmp-3"><i class="fa fa-check"></i>level 3 (HMP)</a></li>
<li class="chapter" data-level="" data-path="dt-etl.html"><a href="dt-etl.html#level-4-uv-3"><i class="fa fa-check"></i>level 4 (UV)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="dt-etl.html"><a href="dt-etl.html#etl"><i class="fa fa-check"></i>ETL</a>
<ul>
<li class="chapter" data-level="" data-path="dt-etl.html"><a href="dt-etl.html#чтение-и-запись-текстовых-файлов"><i class="fa fa-check"></i>Чтение и запись текстовых файлов</a></li>
<li class="chapter" data-level="" data-path="dt-etl.html"><a href="dt-etl.html#чтение-файлов-ms-excel"><i class="fa fa-check"></i>Чтение файлов MS Excel</a></li>
<li class="chapter" data-level="" data-path="dt-etl.html"><a href="dt-etl.html#чтение-файлов-spss"><i class="fa fa-check"></i>Чтение файлов SPSS</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="dt-etl.html"><a href="dt-etl.html#дополнительная-литература"><i class="fa fa-check"></i>Дополнительная литература</a></li>
<li class="chapter" data-level="" data-path="dt-etl.html"><a href="dt-etl.html#домашнее-задание-6"><i class="fa fa-check"></i>Домашнее задание</a>
<ul>
<li class="chapter" data-level="" data-path="dt-etl.html"><a href="dt-etl.html#level-1-iatytd-2"><i class="fa fa-check"></i>level 1 (IATYTD)</a></li>
<li class="chapter" data-level="" data-path="dt-etl.html"><a href="dt-etl.html#level-2-hntr-2"><i class="fa fa-check"></i>level 2 (HNTR)</a></li>
<li class="chapter" data-level="" data-path="dt-etl.html"><a href="dt-etl.html#level-3-hmp-4"><i class="fa fa-check"></i>level 3 (HMP)</a></li>
<li class="chapter" data-level="" data-path="dt-etl.html"><a href="dt-etl.html#level-4-uv-4"><i class="fa fa-check"></i>level 4 (UV)</a></li>
<li class="chapter" data-level="" data-path="dt-etl.html"><a href="dt-etl.html#level-5-n-2"><i class="fa fa-check"></i>level 5 (N)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="hw-1.html"><a href="hw-1.html"><i class="fa fa-check"></i>HW 1</a>
<ul>
<li class="chapter" data-level="" data-path="hw-1.html"><a href="hw-1.html#общие-замечания"><i class="fa fa-check"></i>Общие замечания</a></li>
<li class="chapter" data-level="" data-path="hw-1.html"><a href="hw-1.html#задание-1.-дома-в-игре-престолов."><i class="fa fa-check"></i>Задание 1. Дома в Игре престолов.</a>
<ul>
<li class="chapter" data-level="" data-path="hw-1.html"><a href="hw-1.html#импорт-данных"><i class="fa fa-check"></i>импорт данных</a></li>
<li class="chapter" data-level="" data-path="hw-1.html"><a href="hw-1.html#чистка-данных"><i class="fa fa-check"></i>чистка данных</a></li>
<li class="chapter" data-level="" data-path="hw-1.html"><a href="hw-1.html#график-численности-кланов"><i class="fa fa-check"></i>график численности кланов</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hw-1.html"><a href="hw-1.html#задание-2.-агрессивность-персонажей-в-книгах-о-гарри-поттере."><i class="fa fa-check"></i>Задание 2. Агрессивность персонажей в книгах о Гарри Поттере.</a></li>
<li class="chapter" data-level="" data-path="hw-1.html"><a href="hw-1.html#задание-3.-динамика-среднегодовой-температуры-в-период-1750-2015"><i class="fa fa-check"></i>Задание 3. Динамика среднегодовой температуры в период 1750-2015</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Автоматизированный сбор больших данных в экономико-социологических исследованиях</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data.table-pt2" class="section level1 unnumbered hasAnchor">
<h1>data.table pt2<a href="data.table-pt2.html#data.table-pt2" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="запись-занятия-3" class="section level2 unnumbered hasAnchor">
<h2>Запись занятия<a href="data.table-pt2.html#запись-занятия-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Запись занятия 7 октября:</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/sbDHNk2R8nA?si=92jh3dwAVNohxMTW" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen>
</iframe>
</div>
<div id="разбор-домашней-работы-1" class="section level2 unnumbered hasAnchor">
<h2>Разбор домашней работы<a href="data.table-pt2.html#разбор-домашней-работы-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="работа-с-колонками-2" class="section level3 unnumbered hasAnchor">
<h3>работа с колонками<a href="data.table-pt2.html#работа-с-колонками-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>выделите в отдельный датасет всех погибших пассажиров, оставьте для них только значения пола, возраста и класса билета (<code>pclass</code>), переменную <code>pclass</code> переименуйте в <code>class</code></li>
</ul>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="data.table-pt2.html#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb215-2"><a href="data.table-pt2.html#cb215-2" aria-hidden="true" tabindex="-1"></a>titanic <span class="ot">&lt;-</span> <span class="fu">fread</span>(<span class="st">&#39;https://gitlab.com/hse_mar/mar221s/-/raw/master/data/titanic3.csv&#39;</span>)</span>
<span id="cb215-3"><a href="data.table-pt2.html#cb215-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-4"><a href="data.table-pt2.html#cb215-4" aria-hidden="true" tabindex="-1"></a>titanic_not_survived <span class="ot">&lt;-</span> titanic[survived <span class="sc">==</span> <span class="dv">0</span>, <span class="fu">list</span>(sex, age, <span class="at">class =</span> pclass)]</span>
<span id="cb215-5"><a href="data.table-pt2.html#cb215-5" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(titanic_not_survived)</span></code></pre></div>
<pre><code>## Classes &#39;data.table&#39; and &#39;data.frame&#39;:   809 obs. of  3 variables:
##  $ sex  : chr  &quot;female&quot; &quot;male&quot; &quot;female&quot; &quot;male&quot; ...
##  $ age  : num  2 30 25 39 71 47 NA 24 36 25 ...
##  $ class: int  1 1 1 1 1 1 1 1 1 1 ...
##  - attr(*, &quot;.internal.selfref&quot;)=&lt;externalptr&gt;</code></pre>
<ul>
<li>в полученном датасете посчитайте количество пассажиров, их средний и медианный возраст, разброс по возрасту (<code>sd()</code>)</li>
</ul>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="data.table-pt2.html#cb217-1" aria-hidden="true" tabindex="-1"></a>titanic_not_survived[, <span class="fu">list</span>(</span>
<span id="cb217-2"><a href="data.table-pt2.html#cb217-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">n_rows =</span> .N,</span>
<span id="cb217-3"><a href="data.table-pt2.html#cb217-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">age_mn =</span> <span class="fu">mean</span>(age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb217-4"><a href="data.table-pt2.html#cb217-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">age_md =</span> <span class="fu">median</span>(age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb217-5"><a href="data.table-pt2.html#cb217-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">age_sd =</span> <span class="fu">sd</span>(age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))]</span></code></pre></div>
<pre><code>##    n_rows   age_mn age_md   age_sd
## 1:    809 30.54536     28 13.92255</code></pre>
<ul>
<li>*в датасете titanic попробуйте построить логистическую регрессию, которая бы предсказывала вероятность выживания пассажира (<code>survived</code>).</li>
</ul>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="data.table-pt2.html#cb219-1" aria-hidden="true" tabindex="-1"></a>lm_fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(survived <span class="sc">~</span> sex <span class="sc">+</span> age <span class="sc">+</span> pclass <span class="sc">+</span> fare, <span class="at">data =</span> titanic, <span class="at">family =</span> <span class="st">&#39;binomial&#39;</span>)</span>
<span id="cb219-2"><a href="data.table-pt2.html#cb219-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_fit)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = survived ~ sex + age + pclass + fare, family = &quot;binomial&quot;, 
##     data = titanic)
## 
## Coefficients:
##               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  4.5009747  0.4616310   9.750  &lt; 2e-16 ***
## sexmale     -2.4899900  0.1669830 -14.912  &lt; 2e-16 ***
## age         -0.0336871  0.0062977  -5.349 8.84e-08 ***
## pclass      -1.1079840  0.1284987  -8.623  &lt; 2e-16 ***
## fare         0.0006614  0.0017242   0.384    0.701    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1413.57  on 1044  degrees of freedom
## Residual deviance:  982.81  on 1040  degrees of freedom
##   (264 observations deleted due to missingness)
## AIC: 992.81
## 
## Number of Fisher Scoring iterations: 4</code></pre>
</div>
<div id="для-тех-кто-любит-посложнее-1" class="section level3 unnumbered hasAnchor">
<h3>для тех, кто любит посложнее<a href="data.table-pt2.html#для-тех-кто-любит-посложнее-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Создайте датасет:</p>
<ul>
<li>несколько пользователей</li>
<li>по 5 сессий на каждого пользователя.</li>
<li>поле логина, тип – дата и время (таймстамп), все логины в интервале 1-9 сентября. В юникс-формате или просто дата и время, на ваше усмотрение.</li>
<li>для каждой сессии создайте случайную длину сессии (достаточно просто вектор длиной со всю таблицу, без учета пользователей) в секундах. Длина сессии должна варьировать в пределах 120 - 600 секунд</li>
<li>посчитайте количество пользователей, среднее количество сессий на пользователя, среднюю длину сессий. Без учета вариативности внутри пользователя, overall по всему датасету.</li>
</ul>
<p>Подсказки:</p>
<ul>
<li>датасет лучше создавать в несколько шагов</li>
<li>есть полезная функция <code>expand.grid()</code></li>
<li>для генерации времени поможет функция <code>as.POSIXct()</code>, плюс есть немного справочных материалов в учебнике: <a href="https://textbook.rintro.ru/objects.html#objects-time">раз</a>, <a href="https://textbook.rintro.ru/manipulations.html#manipulations-time">два</a></li>
</ul>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="data.table-pt2.html#cb221-1" aria-hidden="true" tabindex="-1"></a>my_dt <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb221-2"><a href="data.table-pt2.html#cb221-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste0</span>(<span class="st">&#39;user_&#39;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>),</span>
<span id="cb221-3"><a href="data.table-pt2.html#cb221-3" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb221-4"><a href="data.table-pt2.html#cb221-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb221-5"><a href="data.table-pt2.html#cb221-5" aria-hidden="true" tabindex="-1"></a>my_dt <span class="ot">&lt;-</span> <span class="fu">as.data.table</span>(my_dt)</span>
<span id="cb221-6"><a href="data.table-pt2.html#cb221-6" aria-hidden="true" tabindex="-1"></a><span class="fu">setnames</span>(my_dt, <span class="fu">c</span>(<span class="st">&#39;uid&#39;</span>, <span class="st">&#39;sid&#39;</span>))</span>
<span id="cb221-7"><a href="data.table-pt2.html#cb221-7" aria-hidden="true" tabindex="-1"></a><span class="fu">setkey</span>(my_dt, <span class="st">&#39;uid&#39;</span>)</span>
<span id="cb221-8"><a href="data.table-pt2.html#cb221-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-9"><a href="data.table-pt2.html#cb221-9" aria-hidden="true" tabindex="-1"></a>time_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">as.POSIXct</span>(<span class="st">&quot;2023-09-01 00:00:00&quot;</span>), <span class="fu">as.POSIXct</span>(<span class="st">&quot;2023-09-09 23:59:59&quot;</span>), <span class="at">by =</span> <span class="st">&quot;s&quot;</span>)</span>
<span id="cb221-10"><a href="data.table-pt2.html#cb221-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-11"><a href="data.table-pt2.html#cb221-11" aria-hidden="true" tabindex="-1"></a>my_dt[, login_ts <span class="sc">:</span><span class="er">=</span> <span class="fu">sort</span>(<span class="fu">sample</span>(time_seq, .N))]</span>
<span id="cb221-12"><a href="data.table-pt2.html#cb221-12" aria-hidden="true" tabindex="-1"></a>my_dt[, session_length <span class="sc">:</span><span class="er">=</span> <span class="fu">sample</span>(<span class="dv">120</span><span class="sc">:</span><span class="dv">600</span>, .N)]</span>
<span id="cb221-13"><a href="data.table-pt2.html#cb221-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-14"><a href="data.table-pt2.html#cb221-14" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(my_dt)</span></code></pre></div>
<pre><code>##       uid sid            login_ts session_length
## 1: user_1   1 2023-09-02 03:05:11            568
## 2: user_1   2 2023-09-02 12:45:43            385
## 3: user_1   3 2023-09-03 09:01:06            366
## 4: user_1   4 2023-09-03 10:34:47            134
## 5: user_1   5 2023-09-03 13:37:23            485
## 6: user_2   1 2023-09-04 00:24:21            305</code></pre>
</div>
</div>
<div id="применение-функций" class="section level2 unnumbered hasAnchor">
<h2>Применение функций<a href="data.table-pt2.html#применение-функций" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="dataset" class="section level3 unnumbered hasAnchor">
<h3>dataset<a href="data.table-pt2.html#dataset" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="data.table-pt2.html#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb223-2"><a href="data.table-pt2.html#cb223-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-3"><a href="data.table-pt2.html#cb223-3" aria-hidden="true" tabindex="-1"></a><span class="co"># импортируем по ссылке</span></span>
<span id="cb223-4"><a href="data.table-pt2.html#cb223-4" aria-hidden="true" tabindex="-1"></a>sw <span class="ot">&lt;-</span> <span class="fu">fread</span>(<span class="st">&#39;http://bit.ly/39aOUne&#39;</span>)</span>
<span id="cb223-5"><a href="data.table-pt2.html#cb223-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-6"><a href="data.table-pt2.html#cb223-6" aria-hidden="true" tabindex="-1"></a><span class="co"># смотрим структуру объекта</span></span>
<span id="cb223-7"><a href="data.table-pt2.html#cb223-7" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(sw)</span></code></pre></div>
<pre><code>## Classes &#39;data.table&#39; and &#39;data.frame&#39;:   77 obs. of  6 variables:
##  $ name       : chr  &quot;Luke Skywalker&quot; &quot;C-3PO&quot; &quot;Darth Vader&quot; &quot;Owen Lars&quot; ...
##  $ height     : int  172 167 202 178 165 97 183 188 163 183 ...
##  $ mass       : num  77 75 136 120 75 32 84 84 NA NA ...
##  $ skin_color : chr  &quot;fair&quot; &quot;gold&quot; &quot;white&quot; &quot;light&quot; ...
##  $ gender     : chr  &quot;male&quot; &quot;n/a&quot; &quot;male&quot; &quot;male&quot; ...
##  $ planet_name: chr  &quot;Tatooine&quot; &quot;Tatooine&quot; &quot;Tatooine&quot; &quot;Tatooine&quot; ...
##  - attr(*, &quot;.internal.selfref&quot;)=&lt;externalptr&gt;</code></pre>
</div>
</div>
<div id="применение-функций-1" class="section level2 unnumbered hasAnchor">
<h2>Применение функций<a href="data.table-pt2.html#применение-функций-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="количество-строк-и-значений-.n-uniquen" class="section level3 unnumbered hasAnchor">
<h3>Количество строк и значений: .N, uniqueN<a href="data.table-pt2.html#количество-строк-и-значений-.n-uniquen" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>В data.table есть пара полезных функций, которые позволяет быстро и лаконично считать количество значений и количество уникальных значений.</p>
<p>Считаем количество строк в табличке - для этого используется функция <code>.N</code> (в data.table есть еще несколько функций, которые начинаются с <code>.</code>, но мы их почти не будем касаться).</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="data.table-pt2.html#cb225-1" aria-hidden="true" tabindex="-1"></a>sw[, .N]</span></code></pre></div>
<pre><code>## [1] 77</code></pre>
<p>Функция <code>uniqueN()</code> считает количество уникальных значений. Аналогична сочетанию двух функций <code>length()</code> + <code>unique()</code>, просто короче и быстрее.</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="data.table-pt2.html#cb227-1" aria-hidden="true" tabindex="-1"></a>sw[, <span class="fu">uniqueN</span>(planet_name)]</span></code></pre></div>
<pre><code>## [1] 48</code></pre>
</div>
<div id="ветвления-ifelse-fifelse" class="section level3 unnumbered hasAnchor">
<h3>Ветвления: ifelse / fifelse<a href="data.table-pt2.html#ветвления-ifelse-fifelse" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>В R есть два вида ветвлений с использованием if. Первое - стандартная для многих языков конструкция <code>if {} else{}</code>, она используется при создании функций и т.д. Для работы с таблицами полезнее функция <code>ifelse()</code> или ее быстрый аналог в data.table - <code>fifelse</code> (<code>f</code> от fast).</p>
<p>В первом аргументе функции мы указываем проверку, в результате которой можно будет сказать TRUE или FALSE. Вторым аргументом - что должно быть возвращено, если результат проверки будет TRUE (логическое утверждение из первого аргумента истинно). Третий аргумент - что должно быть возвращено, если утверждение из первого аргумента ложно. Например, мы проверяем, истинно ли, что 5 тождественно 3. Так как 5 не равно трем, результатом сравнения 5 == 3 будет FALSE (утверждение ложно), соответственно, результатом <code>ifelse()</code> будет <code>'значение если неверно'</code>.</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="data.table-pt2.html#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span> <span class="sc">==</span> <span class="dv">3</span></span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="data.table-pt2.html#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ifelse</span>(<span class="dv">5</span> <span class="sc">==</span> <span class="dv">3</span>, <span class="st">&#39;значение если верно&#39;</span>, <span class="st">&#39;значение если неверно&#39;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;значение если неверно&quot;</code></pre>
<p>Ключевое отличие <code>ifelse()</code> от классического <code>if {} else{}</code> в том, что эта функция векторизована. То есть, если в первом аргументе сравнивать вектор с каким-то значением, то проверка будет применяться к каждому элементу вектора. Соответственно, и результатов <code>ifelse</code> будет столько же, сколько элементов в векторе.</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="data.table-pt2.html#cb233-1" aria-hidden="true" tabindex="-1"></a>my_vec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">9</span>)</span>
<span id="cb233-2"><a href="data.table-pt2.html#cb233-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ifelse</span>(my_vec <span class="sc">==</span> <span class="dv">3</span>, <span class="st">&#39;значение если верно&#39;</span>, <span class="st">&#39;значение если неверно&#39;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;значение если неверно&quot; &quot;значение если верно&quot;   &quot;значение если неверно&quot;</code></pre>
<p>Все это позволяет использовать ifelse/fifelse для операций над колонками - например, в примере мы проверяем с помощью функции <code>grepl</code>, встречается ли в значениях ячеек в колонке <code>skin_color</code> слово <code>grey</code>. И если встречается - то в новую колонку будет проставлено значение <code>grey</code>, а если не всречается - <code>no grey</code>.</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="data.table-pt2.html#cb235-1" aria-hidden="true" tabindex="-1"></a>sw[, new <span class="sc">:</span><span class="er">=</span> <span class="fu">fifelse</span>(<span class="fu">grepl</span>(<span class="st">&#39;grey&#39;</span>, skin_color), <span class="st">&#39;grey&#39;</span>, <span class="st">&#39;no grey&#39;</span>)]</span>
<span id="cb235-2"><a href="data.table-pt2.html#cb235-2" aria-hidden="true" tabindex="-1"></a>sw[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="fu">list</span>(name, skin_color, new)]</span></code></pre></div>
<pre><code>##                   name skin_color     new
##  1:     Luke Skywalker       fair no grey
##  2:              C-3PO       gold no grey
##  3:        Darth Vader      white no grey
##  4:          Owen Lars      light no grey
##  5: Beru Whitesun lars      light no grey
##  6:              R5-D4 white, red no grey
##  7:  Biggs Darklighter      light no grey
##  8:   Anakin Skywalker       fair no grey
##  9:     Shmi Skywalker       fair no grey
## 10:        Cliegg Lars       fair no grey</code></pre>
</div>
</div>
<div id="агрегации" class="section level2 unnumbered hasAnchor">
<h2>Агрегации<a href="data.table-pt2.html#агрегации" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>В синтаксисе <code>data.table</code> есть конструкция <code>by</code>, которая отвечает за примененим операций над колонками отдельно для каждой группы (общая структура выглядит следующим образом: <code>dataset[выбор строк, операции над колонками, группировка]</code>).</p>
<p>Общая логика группировки стандартная - <code>split - apply - combine</code>. То есть, датасет разделяется на блоки по значениям группирующей переменной, к колонкам каждого сабсета применяется какое-то выражение, и результат обратно собирается в таблицу. Результатом группировки в <code>data.table</code> всегда будет таблица.
<img src="pics/split-apply-combine.jpg" /></p>
<div id="вычисления-по-одной-колонке-1" class="section level3 unnumbered hasAnchor">
<h3>Вычисления по одной колонке<a href="data.table-pt2.html#вычисления-по-одной-колонке-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Можно использовать группировку при применении функции к таблице, но удобнее результат операции с колонкой оборачивать в <code>list()</code>, так как это дает возможность переименовать колонку. В примере ниже мы считаем количество уникальных значений в колонке <code>name</code> для каждой группы по значениям колонки <code>gender</code>:</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="data.table-pt2.html#cb237-1" aria-hidden="true" tabindex="-1"></a>sw[, <span class="fu">uniqueN</span>(name), by <span class="ot">=</span> gender]</span></code></pre></div>
<pre><code>##           gender V1
## 1:          male 57
## 2:           n/a  3
## 3:        female 16
## 4: hermaphrodite  1</code></pre>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="data.table-pt2.html#cb239-1" aria-hidden="true" tabindex="-1"></a>sw[, <span class="fu">list</span>(<span class="at">n_chars =</span> <span class="fu">uniqueN</span>(name)), by <span class="ot">=</span> gender]</span></code></pre></div>
<pre><code>##           gender n_chars
## 1:          male      57
## 2:           n/a       3
## 3:        female      16
## 4: hermaphrodite       1</code></pre>
</div>
<div id="вычисления-по-нескольким-колонкам" class="section level3 unnumbered hasAnchor">
<h3>Вычисления по нескольким колонкам<a href="data.table-pt2.html#вычисления-по-нескольким-колонкам" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Можно выполнять операции сразу с несколькими колонками:</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="data.table-pt2.html#cb241-1" aria-hidden="true" tabindex="-1"></a>sw[, <span class="fu">list</span>(</span>
<span id="cb241-2"><a href="data.table-pt2.html#cb241-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">n_chars =</span> <span class="fu">uniqueN</span>(name),</span>
<span id="cb241-3"><a href="data.table-pt2.html#cb241-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">mass_md =</span> <span class="fu">median</span>(mass, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb241-4"><a href="data.table-pt2.html#cb241-4" aria-hidden="true" tabindex="-1"></a>), by <span class="ot">=</span> gender]</span></code></pre></div>
<pre><code>##           gender n_chars mass_md
## 1:          male      57    80.0
## 2:           n/a       3    32.0
## 3:        female      16    52.5
## 4: hermaphrodite       1      NA</code></pre>
</div>
<div id="группировка-по-нескольким-полям-1" class="section level3 unnumbered hasAnchor">
<h3>Группировка по нескольким полям<a href="data.table-pt2.html#группировка-по-нескольким-полям-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Часто возникает необходимость группировки сразу по нескольким полям - для этого колонки групп также указываются через список. В выражении ниже мы сначала фильтруем датасет и оставляем только строки, где в колонке <code>gender</code> есть значения <code>male</code> и <code>female</code>, после чего в группах по полу и цвету кожи считаем количество персонажей. Результат агрегации записываем в новый объект и выводим на печать только первые 5 строк (просто чтобы сократить вывод).</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="data.table-pt2.html#cb243-1" aria-hidden="true" tabindex="-1"></a>sw_grps <span class="ot">&lt;-</span> sw[gender <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;male&#39;</span>, <span class="st">&#39;female&#39;</span>),</span>
<span id="cb243-2"><a href="data.table-pt2.html#cb243-2" aria-hidden="true" tabindex="-1"></a>              <span class="fu">list</span>(<span class="at">n_chars =</span> <span class="fu">uniqueN</span>(name)),</span>
<span id="cb243-3"><a href="data.table-pt2.html#cb243-3" aria-hidden="true" tabindex="-1"></a>              by <span class="ot">=</span> <span class="fu">list</span>(gender, skin_color)]</span>
<span id="cb243-4"><a href="data.table-pt2.html#cb243-4" aria-hidden="true" tabindex="-1"></a>sw_grps[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code></pre></div>
<pre><code>##    gender skin_color n_chars
## 1:   male       fair      12
## 2:   male      white       2
## 3:   male      light       4
## 4: female      light       5
## 5: female       fair       3</code></pre>
</div>
</div>
<div id="манипуляции-с-таблицами" class="section level2 unnumbered hasAnchor">
<h2>Манипуляции с таблицами<a href="data.table-pt2.html#манипуляции-с-таблицами" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="rbind" class="section level3 unnumbered hasAnchor">
<h3>rbind()<a href="data.table-pt2.html#rbind" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Функция <code>rbind()</code>(от <code>row bind</code>) используется для объединение двух или более таблиц по строкам. То есть, в результате получается таблица с таким же количеством колонок, но с увеличенным числом строк - по количеству строк в объединяемых таблицах.</p>
<p>Нередко в объединяемых таблицах отсутствует какая-нибудь колонка или колонки перепутаны. В таких случаях необходимо использовать аргументы <code>use.names = TRUE</code> (проверка названий колонок при объединение) и <code>fill = TRUE</code> (создание колонки с <code>NA</code>-значениями). Обратите внимание, это работает только с <code>data.table</code>-объектами.</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="data.table-pt2.html#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="co"># создаем первую таблицу</span></span>
<span id="cb245-2"><a href="data.table-pt2.html#cb245-2" aria-hidden="true" tabindex="-1"></a>dt1 <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="at">tb =</span> <span class="st">&#39;table_1&#39;</span>,</span>
<span id="cb245-3"><a href="data.table-pt2.html#cb245-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">col1 =</span> <span class="fu">sample</span>(<span class="dv">9</span>, <span class="dv">3</span>),</span>
<span id="cb245-4"><a href="data.table-pt2.html#cb245-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">col3 =</span> <span class="st">&#39;only in table1&#39;</span>,</span>
<span id="cb245-5"><a href="data.table-pt2.html#cb245-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">col2 =</span> <span class="fu">sample</span>(letters, <span class="dv">3</span>))</span>
<span id="cb245-6"><a href="data.table-pt2.html#cb245-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-7"><a href="data.table-pt2.html#cb245-7" aria-hidden="true" tabindex="-1"></a><span class="co"># создаем вторую таблицу</span></span>
<span id="cb245-8"><a href="data.table-pt2.html#cb245-8" aria-hidden="true" tabindex="-1"></a>dt2 <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="at">tb =</span> <span class="st">&#39;table_2&#39;</span>,</span>
<span id="cb245-9"><a href="data.table-pt2.html#cb245-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">col4 =</span> <span class="st">&#39;only in table2&#39;</span>,</span>
<span id="cb245-10"><a href="data.table-pt2.html#cb245-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">col1 =</span> <span class="fu">sample</span>(<span class="dv">9</span>, <span class="dv">3</span>),</span>
<span id="cb245-11"><a href="data.table-pt2.html#cb245-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">col2 =</span> <span class="fu">sample</span>(letters, <span class="dv">3</span>))</span>
<span id="cb245-12"><a href="data.table-pt2.html#cb245-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-13"><a href="data.table-pt2.html#cb245-13" aria-hidden="true" tabindex="-1"></a><span class="co"># объединяем по строкам</span></span>
<span id="cb245-14"><a href="data.table-pt2.html#cb245-14" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(dt1, dt2, <span class="at">fill =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>##         tb col1           col3 col2           col4
## 1: table_1    3 only in table1    d           &lt;NA&gt;
## 2: table_1    7 only in table1    r           &lt;NA&gt;
## 3: table_1    9 only in table1    k           &lt;NA&gt;
## 4: table_2    7           &lt;NA&gt;    f only in table2
## 5: table_2    9           &lt;NA&gt;    w only in table2
## 6: table_2    3           &lt;NA&gt;    o only in table2</code></pre>
</div>
<div id="cbind" class="section level3 unnumbered hasAnchor">
<h3>cbind()<a href="data.table-pt2.html#cbind" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Функция <code>cbind()</code> (от <code>columns bind</code>) используется для объединения нескольких векторов или таблиц равной длины. В результате получается объединённая таблица такой же длины, как каждый из объединяемых векторов. При объединении таблиц — с таким же количеством строк, как в каждой из объединяемых таблиц, и с суммарным количеством колонок.</p>
<p>При использовании <code>cbind()</code> в работе с таблицами необходимо помнить, что это буквально “склейка” таблиц независимо от порядка наблюдений по строкам. В противном случае можно получить наблюдение, где часть колонок описывает характеристики этого наблюдения, а другая часть — каких-то других наблюдений.</p>
<p>Другой нюанс, который также необходимо учитывать: при объединении таблиц названия колонок останутся прежними. Так что если в нескольких таблицах встречается, например, колонка <code>col1</code>, то в финальном датасете будет несколько колонок с таким названием — по количеству объединяемых таблиц, в которых она была. В свою очередь, это усложняет задачи выбора колонки по названию и мешает понять, в какой колонке какое содержание.</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="data.table-pt2.html#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="co"># выведем ранее созданные таблицы</span></span>
<span id="cb247-2"><a href="data.table-pt2.html#cb247-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(dt1)</span></code></pre></div>
<pre><code>##         tb col1           col3 col2
## 1: table_1    3 only in table1    d
## 2: table_1    7 only in table1    r
## 3: table_1    9 only in table1    k</code></pre>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="data.table-pt2.html#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(dt2)</span></code></pre></div>
<pre><code>##         tb           col4 col1 col2
## 1: table_2 only in table2    7    f
## 2: table_2 only in table2    9    w
## 3: table_2 only in table2    3    o</code></pre>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="data.table-pt2.html#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="co"># создадим колонки-номера строк</span></span>
<span id="cb251-2"><a href="data.table-pt2.html#cb251-2" aria-hidden="true" tabindex="-1"></a>dt1[, indx <span class="sc">:</span><span class="er">=</span> <span class="dv">1</span><span class="sc">:</span>.N]</span>
<span id="cb251-3"><a href="data.table-pt2.html#cb251-3" aria-hidden="true" tabindex="-1"></a>dt2[, indx <span class="sc">:</span><span class="er">=</span> <span class="dv">1</span><span class="sc">:</span>.N]</span>
<span id="cb251-4"><a href="data.table-pt2.html#cb251-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb251-5"><a href="data.table-pt2.html#cb251-5" aria-hidden="true" tabindex="-1"></a><span class="co"># теперь отсортируем вторую таблицу по убыванию</span></span>
<span id="cb251-6"><a href="data.table-pt2.html#cb251-6" aria-hidden="true" tabindex="-1"></a>dt2 <span class="ot">&lt;-</span> dt2[<span class="fu">order</span>(<span class="sc">-</span>indx)]</span>
<span id="cb251-7"><a href="data.table-pt2.html#cb251-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb251-8"><a href="data.table-pt2.html#cb251-8" aria-hidden="true" tabindex="-1"></a><span class="co"># таблица получилась, но в строках бардак</span></span>
<span id="cb251-9"><a href="data.table-pt2.html#cb251-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(dt1, dt2)</span></code></pre></div>
<pre><code>##         tb col1           col3 col2 indx      tb           col4 col1 col2 indx
## 1: table_1    3 only in table1    d    1 table_2 only in table2    3    o    3
## 2: table_1    7 only in table1    r    2 table_2 only in table2    9    w    2
## 3: table_1    9 only in table1    k    3 table_2 only in table2    7    f    1</code></pre>
<p>В целом, <code>cbind()</code> — весьма редко используемый способ объединения таблиц. Его стоит использовать только тогда, когда есть однозначная уверенность в структуре данных (одинаковое количество строк, разные названия колонок, идентичная сортировка и т. д.), в противном случае это место, в котором очень легко ошибиться, при этом эту ошибку будет очень сложно найти.</p>
</div>
</div>
<div id="домашнее-задание-4" class="section level2 unnumbered hasAnchor">
<h2>Домашнее задание<a href="data.table-pt2.html#домашнее-задание-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="level-1-iatytd" class="section level3 unnumbered hasAnchor">
<h3>level 1 (IATYTD)<a href="data.table-pt2.html#level-1-iatytd" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Импортируйте данные по Star Wars, файл по ссылке: <a href="http://bit.ly/39aOUne" class="uri">http://bit.ly/39aOUne</a>. Посмотрите структуру объекта. Посчитайте, сколько в таблице строк.</p>
</div>
<div id="level-2-hntr" class="section level3 unnumbered hasAnchor">
<h3>level 2 (HNTR)<a href="data.table-pt2.html#level-2-hntr" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>создайте копию колонки <code>mass</code> с названием <code>mass_corrected</code></p></li>
<li><p>замените все NA в колонке <code>mass_corrected</code> средним значением по группе, группы выделяются по полу и планете (вам потребуется создать промежуточную колонку)</p></li>
</ul>
</div>
<div id="level-3-hmp" class="section level3 unnumbered hasAnchor">
<h3>level 3 (HMP)<a href="data.table-pt2.html#level-3-hmp" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>изучите справку по функции <code>ifelse()</code> (или <code>fifelse()</code> в data.table)</p></li>
<li><p>создайте копию колонки <code>gender</code>, назовите ее <code>gender_2</code>. Замените в ней все <code>n/a</code> и <code>hermaphrodite</code> на <code>other</code>. Посчитайте количество персонажей в зависимости от пола (<code>gender_2</code>):</p></li>
</ul>
<pre><code>##    gender_2  N
## 1:     male 57
## 2:    other  4
## 3:   female 16</code></pre>
<ul>
<li>выполните предыдущее задание без создания промежуточной колонки <code>gender_2</code></li>
</ul>
</div>
<div id="level-4-uv" class="section level3 unnumbered hasAnchor">
<h3>level 4 (UV)<a href="data.table-pt2.html#level-4-uv" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>сделайте сводную таблицу <code>planet_chars</code> по персонажам каждой планеты, где в колонках будет количество персонажей, их средний рост и вес (оригинальный и скорректированный).</p></li>
<li><p>округлите значения до 1 знака после запятой</p></li>
</ul>
<p>Первые 5 строк результата:</p>
<pre><code>##    planet_name n_chars height_mn mass_mn mass_corrected_mn
## 1:    Tatooine      10     169.8    85.4              85.8
## 2:      Kamino       3     208.3    83.1              83.1
## 3:    Geonosis       1     183.0    80.0              80.0
## 4:      Utapau       1     206.0    80.0              80.0
## 5:    Kashyyyk       2     231.0   124.0             124.0</code></pre>
</div>
<div id="level-5-n" class="section level3 unnumbered hasAnchor">
<h3>level 5 (N)<a href="data.table-pt2.html#level-5-n" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Создайте датасет:</p>
<ul>
<li>несколько пользователей (например, 100), должен быть отдельный параметр <code>user_type</code> с значениями short, medium, long</li>
<li>от 1 до 10 сессий на каждого пользователя, случайным образом.</li>
<li>создайте поле логина, тип – дата и время (таймстамп), все логины в интервале 1-9 сентября. В юникс-формате или просто дата и время, на ваше усмотрение.</li>
<li>создайте колонку session_num, которая будет маркировать номер сессии пользователя</li>
<li>для каждой сессии создайте случайную длину сессии в секундах. Длина сессии должна варьировать в пределах 120 - 600 секунд. Длина сессии зависит от параметра <code>user_type</code>:
<ul>
<li>short: множитель к длине сессии из интервала (0, 1] (например, 0.27)</li>
<li>medium: множитель к длине сессии из интервала (1, 3] (например, 2.51)</li>
<li>long: множитель к длине сессии из интервала (5, 7] (например, 6.1)</li>
</ul></li>
</ul>
<p>Посчитайте в датасете:</p>
<ul>
<li>количество пользователей</li>
<li>среднее количество сессий на пользователя</li>
<li>средний</li>
<li>среднюю длину сессий</li>
<li>средний интервал между концом одной сессии и началом другой сессии (обратите внимание на функцию <code>shift</code>)</li>
</ul>
<p>Расчеты в группах по <code>user_type</code> и <code>total</code> (без группировки). В итоговой таблице должно быть 4 строки и 5 колонок.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data.table-pt1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="data.table-pt3.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toolbar": {
"position": "static"
}
});
});
</script>

</body>

</html>
